import{d as b,a as o,b as T,o as x,c as m,e as _,F as R,r as A,n as F,f as w,g as L,_ as E,h as H,i as N,w as U,t as z}from"./index-BIHiBzaX.js";const P=["data-index"],j=b({__name:"VirtualSlide",props:{count:{default:5},total:{default:0},list:{default:()=>[]}},emits:["refresh","load","updateActiveIndex"],setup(g,{emit:v}){const a=g,r=v,i=o(),d=o(),n=o([]),e=o(0),p=o(0),u=o(0),M=o(0),c=o(document.documentElement.clientHeight),f=o(0);function $(t){p.value=t.touches[0].clientY,M.value=Date.now()}function S(t){if(u.value=t.touches[0].clientY-p.value,e.value===0&&u.value>0){r("refresh");return}e.value===a.total-1&&u.value<0||y(u.value-e.value*c.value,"none")}function D(){if(k()){if(u.value>0){if(e.value===0)return;e.value--}if(u.value<0){if(e.value===a.total-1)return;e.value++,e.value+n.value.length>=a.list.length&&V()}}y(-e.value*c.value,"all 0.3s"),Y(),F(()=>{r("updateActiveIndex",e.value)}),B()}function V(){r("load")}function Y(){if(k()){if(u.value>0&&e.value!==0){const t=n.value[0].index,l=a.list.findIndex(s=>s.index===t);n.value.pop(),n.value.unshift({...l!==-1?a.list[l-1]:{},uuid:h()}),f.value-=c.value}if(u.value<0&&e.value>1&&e.value-1<a.total-1){const t=n.value.slice(-1)[0].index,l=a.list.findIndex(s=>s.index===t);n.value.shift(),n.value.push({...l!==-1?a.list[l+1]:{},uuid:h()}),f.value+=c.value}}}function y(t,l){d.value.style.transition=l,d.value.style.transform=`translateY(${t}px)`}function B(){p.value=0,u.value=0}function C(){f.value=0,e.value=0,n.value=a.list.slice(0,Math.min(a.total,a.count)).map(t=>({...t,uuid:h()}))}function k(){const t=Date.now()-M.value,s=Math.abs(u.value)/t>.5;return Math.abs(u.value)>c.value/2||s}function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const l=Math.random()*16|0;return(t==="x"?l:l&3|8).toString(16)})}return T(()=>{C(),r("updateActiveIndex",e.value)}),(t,l)=>(x(),m("div",{ref_key:"wrapperRef",ref:i,class:"wrapper",onTouchstart:$,onTouchmove:S,onTouchend:D},[_("div",{ref_key:"listRef",ref:d,class:"list"},[(x(!0),m(R,null,A(n.value,(s,I)=>(x(),m("div",{key:s.uuid,class:"item","data-index":I+e.value,style:w({top:`${Math.max(f.value,0)}px`})},[L(t.$slots,"default",{activeIndex:e.value,data:s},void 0)],12,P))),128))],512)],544))}}),q=E(j,[["__scopeId","data-v-bb92bdc0"]]);function G(){return`rgb(${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)})`}const K=b({__name:"slide",setup(g){const v=o([]),a=o(0);function r(){for(let i=0;i<10;i++)v.value.push({index:i+1,title:`第${i+1}个`,background:G()});a.value=10}return T(()=>{r()}),(i,d)=>a.value?(x(),H(q,{key:0,list:v.value,total:a.value},{default:U(({data:n})=>[_("div",{style:w({background:n.background,height:"100%"})},[_("div",null,z(n.title),1)],4)]),_:1},8,["list","total"])):N("",!0)}});export{K as default};
