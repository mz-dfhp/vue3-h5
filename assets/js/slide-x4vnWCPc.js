import{d as T,a as u,b as w,o as x,c as m,e as _,F as R,r as A,n as F,f as $,g as L,_ as E,h as H,i as N,w as U,t as z}from"./index-BHplp6nW.js";const P=["data-index"],j=T({__name:"VirtualSlide",props:{count:{default:5},total:{default:0},list:{default:()=>[]}},emits:["refresh","load","updateActiveIndex"],setup(g,{emit:d}){const a=g,r=d,i=u(),v=u(),n=u([]),e=u(0),p=u(0),l=u(0),M=u(0),c=u(document.documentElement.clientHeight),f=u(0);function b(t){p.value=t.touches[0].clientY,M.value=Date.now()}function S(t){if(l.value=t.touches[0].clientY-p.value,e.value===0&&l.value>0){r("refresh");return}e.value===a.total-1&&l.value<0||y(l.value-e.value*c.value,"none")}function D(){if(k()){if(l.value>0){if(e.value===0)return;e.value--}if(l.value<0){if(e.value===a.total-1)return;e.value++,e.value+n.value.length>=a.list.length&&V()}}y(-e.value*c.value,"all 0.3s"),Y(),F(()=>{r("updateActiveIndex",e.value)}),B()}function V(){r("load")}function Y(){if(k()){if(l.value>0&&e.value!==0){const t=n.value[0].index,o=a.list.findIndex(s=>s.index===t);n.value.pop(),n.value.unshift({...a.list[o-1],uuid:h()}),f.value-=c.value}if(l.value<0&&e.value>1&&e.value-1<a.total-1){const t=n.value.slice(-1)[0].index,o=a.list.findIndex(s=>s.index===t);n.value.shift(),n.value.push({...a.list[o+1],uuid:h()}),f.value+=c.value}}}function y(t,o){v.value.style.transition=o,v.value.style.transform=`translateY(${t}px)`}function B(){p.value=0,l.value=0}function C(){f.value=0,e.value=0,n.value=a.list.slice(0,Math.min(a.total,a.count)).map(t=>({...t,uuid:h()}))}function k(){const t=Date.now()-M.value,s=Math.abs(l.value)/t>.5;return Math.abs(l.value)>c.value/2||s}function h(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const o=Math.random()*16|0;return(t==="x"?o:o&3|8).toString(16)})}return w(()=>{C(),r("updateActiveIndex",e.value)}),(t,o)=>(x(),m("div",{ref_key:"wrapperRef",ref:i,class:"wrapper",onTouchstart:b,onTouchmove:S,onTouchend:D},[_("div",{ref_key:"listRef",ref:v,class:"list"},[(x(!0),m(R,null,A(n.value,(s,I)=>(x(),m("div",{key:s.uuid,class:"item","data-index":I+e.value,style:$({top:`${Math.max(f.value,0)}px`})},[L(t.$slots,"default",{activeIndex:e.value,data:s},void 0)],12,P))),128))],512)],544))}}),q=E(j,[["__scopeId","data-v-d93c0a8d"]]);function G(){return`rgb(${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)}, ${Math.floor(Math.random()*256)})`}const K=T({__name:"slide",setup(g){const d=u([]),a=u(0);function r(){for(let i=0;i<10;i++)d.value.push({index:i+1,title:`第${i+1}个`,background:G()});a.value=10}return w(()=>{r()}),(i,v)=>a.value?(x(),H(q,{key:0,list:d.value,total:a.value},{default:U(({data:n})=>[_("div",{style:$({background:n.background,height:"100%"})},[_("div",null,z(n.title),1)],4)]),_:1},8,["list","total"])):N("",!0)}});export{K as default};
